<!-- LnwShop: กล่องทดลองสอบก่อนซื้อ + แบรนด์ + CTA -->
<div id="lnwq-box" aria-live="polite">
  <div class="lnwq-container" role="region" aria-label="แบบทดลองสอบ">
    <div class="lnwq-header">
      <h2 class="lnwq-title">แบบทดลองสอบ: นักวิชาการพาณิชย์</h2>
      <p class="lnwq-subtitle">กรมเจรจาการค้าระหว่างประเทศ</p>
      <!-- แสดงลิขสิทธิ์/เครดิตร้าน -->
      <p class="lnwq-brand">
        ร้านหนังสือ <b>Open Sheets</b> — จัดจำหน่ายหนังสือแนวข้อสอบ |
        LINE: <b>@openshetts</b>
      </p>
    </div>

    <div class="lnwq-body">
      <div id="lnwq-question-area" class="lnwq-card lnwq-active">
        <p id="lnwq-question-text" class="lnwq-qtext">1. คำถามจะแสดงที่นี่</p>
        <div id="lnwq-answers" class="lnwq-answers" role="group" aria-label="ตัวเลือกคำตอบ"></div>

        <div id="lnwq-explain" class="lnwq-explain" hidden>
          <strong>คำอธิบาย:</strong> <span id="lnwq-explain-text"></span>
        </div>

        <div class="lnwq-nav">
          <span id="lnwq-progress" class="lnwq-progress">ข้อ 1 / 10</span>
          <button id="lnwq-next" class="lnwq-btn" disabled>ข้อต่อไป</button>
        </div>
      </div>

      <div id="lnwq-results" class="lnwq-card" hidden>
        <h3 class="lnwq-result-title">ผลการทดสอบ</h3>
        <p>คุณทำได้</p>
        <div id="lnwq-score" class="lnwq-score">0 / 10</div>

        <!-- CTA ปลายทาง -->
        <div class="lnwq-cta">
          <p class="lnwq-cta-text">หากสนใจสั่งซื้อไฟล์/เล่ม กดปุ่มด้านล่างได้เลย</p>
          <a id="lnwq-btn-line" class="lnwq-btn lnwq-line" target="_blank" rel="noopener">แชทกับแอดมิน (LINE)</a>
          <a id="lnwq-btn-shop" class="lnwq-btn lnwq-shop" target="_blank" rel="noopener">สั่งซื้อที่หน้าร้าน</a>
        </div>

        <button id="lnwq-restart" class="lnwq-btn lnwq-success">ทำแบบทดสอบใหม่</button>
      </div>
    </div>
  </div>
</div>

<style>
  /* ===== Scoped styles (prefix lnwq-) ===== */
  #lnwq-box{--p:#005c97;--p2:#363795;--ok:#198754;--bad:#dc3545;--muted:#6c757d;--text:#333}
  #lnwq-box{font-family:"Sarabun",system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans Thai",sans-serif;color:var(--text)}
  #lnwq-box .lnwq-container{background:#fff;border-radius:14px;box-shadow:0 6px 24px rgba(0,0,0,.08);max-width:800px;margin:16px auto;overflow:hidden}
  #lnwq-box .lnwq-header{background:linear-gradient(135deg,var(--p),var(--p2));color:#fff;padding:18px 22px;text-align:center}
  #lnwq-box .lnwq-title{margin:0;font-size:1.35rem}
  #lnwq-box .lnwq-subtitle{margin:.25rem 0 0;opacity:.95}
  #lnwq-box .lnwq-brand{margin:.35rem 0 0;opacity:.95;font-size:.95rem}
  #lnwq-box .lnwq-body{padding:22px}
  #lnwq-box .lnwq-card{display:block}
  #lnwq-box .lnwq-qtext{font-weight:700;line-height:1.6;font-size:1.05rem;margin:0 0 16px}
  #lnwq-box .lnwq-answers{display:grid;gap:10px}
  #lnwq-box .lnwq-answer{background:#f8f9fa;border:2px solid #ced4da;border-radius:10px;padding:12px 14px;text-align:left;cursor:pointer;transition:.18s}
  #lnwq-box .lnwq-answer:hover:not([disabled]){background:#eef2f6;border-color:#0d6efd}
  #lnwq-box .lnwq-answer[aria-pressed="true"]{background:#cfe2ff;border-color:#0d6efd;font-weight:600}
  #lnwq-box .lnwq-answer.lnwq-correct{background:#d1e7dd;border-color:var(--ok);color:#0f5132;font-weight:700}
  #lnwq-box .lnwq-answer.lnwq-wrong{background:#f8d7da;border-color:var(--bad);color:#842029}
  #lnwq-box .lnwq-answer:disabled{opacity:.9;cursor:not-allowed}
  #lnwq-box .lnwq-explain{background:#f8f9fa;border-left:5px solid #6c757d;padding:12px 14px;margin-top:14px;font-size:.98rem}
  #lnwq-box .lnwq-nav{display:flex;justify-content:space-between;align-items:center;margin-top:18px;padding-top:14px;border-top:1px solid #eee}
  #lnwq-box .lnwq-progress{font-weight:600}
  #lnwq-box .lnwq-btn{background:#0d6efd;color:#fff;border:none;border-radius:10px;padding:10px 18px;font-weight:700;cursor:pointer;transition:.18s;display:inline-block;text-decoration:none}
  #lnwq-box .lnwq-btn:hover:not([disabled]){filter:brightness(.95)}
  #lnwq-box .lnwq-btn:disabled{background:var(--muted);cursor:not-allowed}
  #lnwq-box .lnwq-success{background:#28a745}
  #lnwq-box .lnwq-result-title{font-size:1.6rem;margin:0 0 6px}
  #lnwq-box .lnwq-score{font-size:2.6rem;font-weight:800;color:var(--p);margin:6px 0 14px}
  #lnwq-box .lnwq-cta{margin:8px 0 16px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  #lnwq-box .lnwq-cta-text{margin:0 10px 0 0}
  #lnwq-box .lnwq-line{background:#06c755}
  #lnwq-box .lnwq-shop{background:#0d6efd}
  @media (max-width:480px){
    #lnwq-box .lnwq-body{padding:16px}
    #lnwq-box .lnwq-title{font-size:1.15rem}
    #lnwq-box .lnwq-cta{flex-direction:column;align-items:stretch}
  }
</style>

<script>
/* ===== LnwShop Quiz (isolated scope) ===== */
(function(){
  const $$ = (sel,root=document)=>root.querySelector(sel);
  const $$$ = (sel,root=document)=>Array.from(root.querySelectorAll(sel));

  /* === ตั้งค่าแบรนด์/ลิงก์ === */
  const LINE_OA_ID = '@openshetts'; // แก้เป็น OA ของร้าน
  const SHOP_URL   = 'https://www.opensheetsstore.com/product/376/%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AA%E0%B8%AD%E0%B8%9A-%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%9E%E0%B8%B1%E0%B8%92%E0%B8%99%E0%B8%B2%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3-%E0%B8%AA%E0%B8%B3%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99-%E0%B8%81-%E0%B8%9E-%E0%B8%A3-%E0%B8%AD%E0%B8%B1%E0%B8%9B%E0%B9%80%E0%B8%94%E0%B8%95%E0%B8%A5%E0%B9%88%E0%B8%B2%E0%B8%AA%E0%B8%B8%E0%B8%94%E0%B8%9B%E0%B8%B5-2568-%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B2'; // ลิงก์หน้าร้าน/หน้าสินค้า
  const LINE_ADD_FRIEND = 'https://lin.ee/R9kTJB0' + encodeURIComponent(LINE_OA_ID); // ถ้ามีลิงก์ lin.ee ให้แทนได้
  const lineMsg = 'สวัสดีครับ/ค่ะ สนใจสั่งซื้อสินค้านี้ ' + (window.location.href || '');

  // หัวเรื่อง
  const quizHeader = {
    title: "แบบทดลองสอบ: นักวิชาการพาณิชย์",
    subtitle: "กรมเจรจาการค้าระหว่างประเทศ"
  };

  // ข้อสอบ
  const quizData = [
    { q:"ข้อใดคือหลักการที่สำคัญที่สุดขององค์การการค้าโลก (WTO) ที่ส่งเสริมการแข่งขันอย่างเป็นธรรม?",
      a:[{t:"หลักการไม่เลือกปฏิบัติ (Non-Discrimination)",ok:true},{t:"หลักการค้าเสรี (Free Trade)",ok:false},{t:"หลักการโปร่งใส (Transparency)",ok:false},{t:"หลักการใช้มาตรการปกป้อง (Safeguard Measures)",ok:false}],
      ex:"หลักการนี้รวม MFN และ National Treatment เพื่อให้ทุกประเทศแข่งขันบนกติกาเดียวกัน"},
    { q:"ความตกลงใดของ WTO ที่เกี่ยวข้องโดยตรงกับการคุ้มครองทรัพย์สินทางปัญญา?",
      a:[{t:"GATT",ok:false},{t:"GATS",ok:false},{t:"TRIPS",ok:true},{t:"TBT",ok:false}],
      ex:"TRIPS กำหนดมาตรฐานขั้นต่ำด้านทรัพย์สินทางปัญญาที่สมาชิกต้องถือปฏิบัติ"},
    { q:"ข้อใดไม่ใช่เสาหลักของประชาคมเศรษฐกิจอาเซียน (AEC Blueprint)?",
      a:[{t:"การเป็นตลาดและฐานการผลิตเดียว",ok:false},{t:"การสร้างขีดความสามารถในการแข่งขัน",ok:false},{t:"การรวมตัวเข้ากับเศรษฐกิจโลก",ok:false},{t:"การจัดตั้งกองทุนการเงินอาเซียน",ok:true}],
      ex:"AEC Blueprint 2025 มี 4 เสาหลักตามคู่มือ ไม่รวมกองทุนการเงินแบบ IMF"},
    { q:'ในบริบทของ FTA "กฎว่าด้วยแหล่งกำเนิดสินค้า" (Rules of Origin) สำคัญอย่างไร?',
      a:[{t:"กำหนดอัตราภาษีแน่นอนทุกประเภท",ok:false},{t:"ยืนยันว่าสินค้าที่ได้สิทธิภาษีเป็นของประเทศภาคีจริง",ok:true},{t:"ควบคุมมาตรฐาน SPS",ok:false},{t:"จำกัดโควตานำเข้า",ok:false}],
      ex:"ป้องกันการสวมสิทธิ ต้องพิสูจน์สัญชาติสินค้า"},
    { q:'ลักษณะสำคัญของ "Single Undertaking" ในรอบอุรุกวัยคือข้อใด?',
      a:[{t:"เลือกยอมรับเฉพาะบางความตกลงได้",ok:false},{t:"ต้องยอมรับทั้งชุดหรือปฏิเสธทั้งชุด",ok:true},{t:"เจรจาทีละหัวข้อจนจบ",ok:false},{t:"ประเทศกำลังพัฒนาได้ยกเว้นส่วนใหญ่",ok:false}],
      ex:'แนวคิด "Nothing is agreed until everything is agreed."'},
    { q:"หากไทยจะใช้มาตรการตอบโต้การทุ่มตลาด หน่วยงานไต่สวนหลักคือ?",
      a:[{t:"กรมศุลกากร",ok:false},{t:"กรมเจรจาการค้าระหว่างประเทศ",ok:false},{t:"กรมการค้าต่างประเทศ",ok:true},{t:"กขค.",ok:false}],
      ex:"กรมการค้าต่างประเทศ (DFT) ดูแล AD/CVD/Safeguards"},
    { q:"ข้อใดคือความต่างสำคัญระหว่าง RCEP และ CPTPP?",
      a:[{t:"RCEP มาตรฐานแรงงาน/สิ่งแวดล้อมสูงกว่า",ok:false},{t:"RCEP ริเริ่มโดยจีน ส่วน CPTPP โดยสหรัฐ",ok:false},{t:"RCEP มีสมาชิก/ขนาดเศรษฐกิจรวมใหญ่กว่า",ok:true},{t:"CPTPP เน้นภาษีสินค้า ส่วน RCEP เน้นบริการ",ok:false}],
      ex:"RCEP 15 ประเทศ ใหญ่สุดเมื่อวัด GDP+ประชากร"},
    { q:"BATNA ในการเจรจาการค้าหมายถึงอะไร?",
      a:[{t:"ข้อเสนอที่อีกฝ่ายให้ดีที่สุด",ok:false},{t:"จุดยืนสุดท้ายที่ต่อรองไม่ได้",ok:false},{t:"ทางเลือกที่ดีที่สุดหากเจรจาไม่สำเร็จ",ok:true},{t:"ข้อตกลงเบื้องต้นร่วมกัน",ok:false}],
      ex:"BATNA ที่ดีทำให้พลังต่อรองสูงขึ้น"},
    { q:"เมื่อ EU ใช้ CBAM ระยะแรก สินค้าไทยใดกระทบมาก?",
      a:[{t:"เกษตร/อาหารแปรรูป",ok:false},{t:"เหล็ก เหล็กกล้า อะลูมิเนียม ปุ๋ย",ok:true},{t:"อิเล็กทรอนิกส์/ยานยนต์",ok:false},{t:"สิ่งทอ",ok:false}],
      ex:"กลุ่มเข้มคาร์บอนสูง เช่น เหล็ก ปุ๋ย ซีเมนต์ ฯลฯ"},
    { q:"วัตถุประสงค์หลักของ National Single Window (NSW) ของไทยคือ?",
      a:[{t:"พอร์ทัลขอ BOI สำหรับต่างชาติ",ok:false},{t:"จุดเดียวเชื่อมข้อมูลนำเข้า-ส่งออก/โลจิสติกส์",ok:true},{t:"คลังข้อมูลกฎหมายการค้าทั้งหมด",ok:false},{t:"แพลตฟอร์มเจรจาการค้าระหว่างหน่วยงาน",ok:false}],
      ex:"ลดซ้ำซ้อน เอกสารผ่านช่องทางเดียว อำนวยความสะดวกการค้า"}
  ];

  // DOM
  const root = document.getElementById('lnwq-box');
  $$('.lnwq-title', root).textContent = quizHeader.title;
  $$('.lnwq-subtitle', root).textContent = quizHeader.subtitle;

  const area = $$('#lnwq-question-area', root);
  const results = $$('#lnwq-results', root);
  const qText = $$('#lnwq-question-text', root);
  const ansWrap = $$('#lnwq-answers', root);
  const nextBtn = $$('#lnwq-next', root);
  const progress = $$('#lnwq-progress', root);
  const scoreText = $$('#lnwq-score', root);
  const restartBtn = $$('#lnwq-restart', root);
  const exBox = $$('#lnwq-explain', root);
  const exText = $$('#lnwq-explain-text', root);

  // CTA refs
  const btnLine = $$('#lnwq-btn-line', root);
  const btnShop = $$('#lnwq-btn-shop', root);

  // set CTA links
  const lineMsgUrl = 'https://line.me/R/oaMessage/' + encodeURIComponent(LINE_OA_ID) + '/?' + encodeURIComponent(lineMsg);
  btnLine.href = lineMsgUrl; // เปิดแชท OA พร้อมข้อความ
  btnShop.href = SHOP_URL;   // ลิงก์ไปหน้าร้าน/หน้าสินค้า

  let idx = 0, score = 0, locked = false;

  function renderQuestion(){
    locked = false;
    nextBtn.disabled = true;
    exBox.hidden = true;
    ansWrap.innerHTML = "";

    const item = quizData[idx];
    qText.textContent = `ข้อ ${idx+1}. ${item.q}`;
    progress.textContent = `ข้อ ${idx+1} / ${quizData.length}`;

    item.a.forEach((opt,i)=>{
      const btn = document.createElement('button');
      btn.className = 'lnwq-answer';
      btn.type = 'button';
      btn.setAttribute('aria-pressed','false');
      btn.textContent = `${"กขคง"[i] || ""}. ` + opt.t;
      btn.addEventListener('click', ()=> choose(btn,opt.ok));
      ansWrap.appendChild(btn);
    });
  }

  function choose(button,isCorrect){
    if(locked) return;
    locked = true;

    // ล็อกและทำสีทุกช้อยส์
    $$$('.lnwq-answer', root).forEach((b,i)=>{
      b.disabled = true;
      const ok = quizData[idx].a[i].ok;
      b.classList.add(ok ? 'lnwq-correct' : 'lnwq-wrong');
    });

    if(isCorrect) score++;
    exText.textContent = quizData[idx].ex || "";
    exBox.hidden = false;

    if(idx === quizData.length-1){ nextBtn.textContent = 'ดูผลคะแนน'; }
    nextBtn.disabled = false;
  }

  function next(){
    if(idx < quizData.length-1){
      idx++;
      nextBtn.textContent = 'ข้อต่อไป';
      renderQuestion();
    }else{
      showResults();
    }
  }

  function showResults(){
    area.hidden = true;
    results.hidden = false;
    scoreText.textContent = `${score} / ${quizData.length}`;
  }

  function restart(){
    idx = 0; score = 0; locked = false;
    area.hidden = false; results.hidden = true;
    nextBtn.textContent = 'ข้อต่อไป';
    renderQuestion();
  }

  nextBtn.addEventListener('click', next);
  restartBtn.addEventListener('click', restart);

  // เริ่มทำงาน
  renderQuestion();
})();
</script>

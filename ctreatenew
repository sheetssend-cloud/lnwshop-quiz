<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏≠‡∏ö | ‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ Open Sheets</title>
<style>
  :root{--p:#005c97;--p2:#363795;--ok:#198754;--bad:#dc3545;--muted:#6c757d;--text:#333}
  *{box-sizing:border-box}
  html,body{margin:0}
  body{font-family:"Sarabun",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Thai",sans-serif;background:#f0f2f5;user-select:none;-webkit-user-select:none}
  .wrap{max-width:800px;margin:18px auto;background:#fff;border-radius:14px;box-shadow:0 6px 24px rgba(0,0,0,.08);overflow:hidden}
  .header{background:linear-gradient(135deg,var(--p),var(--p2));color:#fff;padding:16px 20px;text-align:center;position:relative}
  .brand{display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap}
  .logo{height:42px;width:auto;object-fit:contain;border-radius:8px;background:#fff10;filter:drop-shadow(0 2px 6px rgba(0,0,0,.25))}
  h2{margin:4px 0 0}
  .sub{margin:4px 0 0;opacity:.95}
  .copyright{margin:8px 0 0;font-size:.95rem;opacity:.95}
  .body{padding:20px}
  .q{font-weight:700;line-height:1.6;margin-bottom:12px}
  .answers{display:grid;gap:10px}
  .opt{background:#f8f9fa;border:2px solid #ced4da;border-radius:10px;padding:12px 14px;text-align:left;cursor:pointer;transition:.18s}
  .opt:hover{background:#eef2f6;border-color:#0d6efd}
  .opt.correct{background:#d1e7dd;border-color:var(--ok);color:#0f5132;font-weight:700}
  .opt.wrong{background:#f8d7da;border-color:var(--bad);color:#842029}
  .ex{background:#f8f9fa;border-left:5px solid #6c757d;padding:12px 14px;margin-top:14px;display:none}
  .nav{display:flex;justify-content:space-between;align-items:center;margin-top:16px;padding-top:12px;border-top:1px solid #eee}
  .btn{background:#0d6efd;color:#fff;border:none;border-radius:10px;padding:10px 18px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
  .btn[disabled]{background:var(--muted);cursor:not-allowed}
  .score{font-size:2.4rem;font-weight:800;color:var(--p);margin:6px 0 14px}
  .result{text-align:center;display:none}
  .success{background:#28a745}
  .cta{margin:8px 0 16px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
  .btn-line{background:#06c755}
  .btn-shop{background:#0d6efd}
  img,svg{pointer-events:none}

  /* ===== ‡πÅ‡∏ú‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Template Panel) ===== */
  .toolbar{position:fixed;right:16px;bottom:16px;z-index:99;display:flex;gap:8px;flex-direction:column}
  .fab{width:52px;height:52px;border-radius:50%;display:grid;place-items:center;font-size:22px;box-shadow:0 6px 18px rgba(0,0,0,.18)}
  .panel{position:fixed;inset:auto 0 0 auto;right:16px;bottom:84px;width:min(560px,calc(100% - 32px));max-height:75vh;background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.18);overflow:hidden;display:none}
  .panel header{background:linear-gradient(135deg,var(--p),var(--p2));color:#fff;padding:12px 16px;font-weight:700;display:flex;justify-content:space-between;align-items:center}
  .panel .content{padding:14px;display:grid;gap:12px}
  .grid{display:grid;grid-template-columns:1fr;gap:10px}
  .row{display:grid;grid-template-columns:140px 1fr;gap:10px;align-items:center}
  .row input,.row textarea{width:100%;padding:10px;border:1px solid #ced4da;border-radius:10px;font-family:inherit}
  .row textarea{min-height:140px}
  .hlp{font-size:.9rem;color:#666;margin:-4px 0 0}
  .panel footer{display:flex;gap:8px;justify-content:flex-end;padding:12px 14px;border-top:1px solid #eee}
  .btn-sec{background:#6c757d}
  .btn-ghost{background:#eef2f6;color:#0d6efd}
  .note{font-size:.92rem;color:#444}
  code.k{background:#f6f7f8;border:1px solid #e5e7eb;border-radius:6px;padding:.1rem .35rem}
</style>
</head>
<body oncontextmenu="return false">
<div class="wrap">
  <div class="header">
    <div class="brand">
      <img id="logo" class="logo" alt="Open Sheets Logo">
      <div>
        <h2 id="title">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏≠‡∏ö: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå</h2>
        <div class="sub" id="subtitle">‡∏Å‡∏£‡∏°‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</div>
        <div class="copyright">‡∏£‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ <b>Open Sheets</b> ‚Äî ‡∏à‡∏±‡∏î‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ô‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö | LINE: <b id="lineid">@openshetts</b></div>
      </div>
    </div>
  </div>

  <div class="body" id="panel">
    <div id="q" class="q">‡∏Ç‡πâ‡∏≠ 1. ‚Ä¶</div>
    <div id="answers" class="answers"></div>
    <div id="ex" class="ex"><b>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</b> <span id="ex-text"></span></div>
    <div class="nav">
      <span id="progress">‡∏Ç‡πâ‡∏≠ 1 / 10</span>
      <button id="next" class="btn" disabled>‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ</button>
    </div>
  </div>

  <div class="body result" id="result">
    <h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h3>
    <div class="score" id="score">0 / 10</div>
    <p>‡∏´‡∏≤‡∏Å‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏ü‡∏•‡πå/‡πÄ‡∏•‡πà‡∏° ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
    <div class="cta">
      <a id="btnLine" class="btn btn-line" target="_blank" rel="noopener">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏≤‡∏á‡πÑ‡∏•‡∏ô‡πå</a>
      <a id="btnShop" class="btn btn-shop" target="_blank" rel="noopener">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</a>
    </div>
    <button id="restart" class="btn success">‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
  </div>
</div>

<!-- ===== Toolbar & Template Panel ===== -->
<div class="toolbar">
  <button id="openPanel" class="btn fab" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤">‚öôÔ∏è</button>
  <button id="restart2" class="btn fab success" title="‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà">üîÑ</button>
</div>

<div class="panel" id="tpl">
  <header>
    <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ)</span>
    <button id="closePanel" class="btn btn-ghost">‡∏õ‡∏¥‡∏î</button>
  </header>
  <div class="content">
    <div class="grid">
      <div class="row">
        <label>‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô</label>
        <input id="fLogo" placeholder="URL ‡∏£‡∏π‡∏õ‡πÇ‡∏•‡πÇ‡∏Å‡πâ (.png/.jpg)" />
      </div>
      <div class="row">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
        <input id="fTitle" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå" />
      </div>
      <div class="row">
        <label>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
        <input id="fSub" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏°‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®" />
      </div>
      <div class="row">
        <label>LINE OA</label>
        <input id="fLine" placeholder="@yourline" />
      </div>
      <div class="row">
        <label>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</label>
        <input id="fShop" placeholder="https://...." />
      </div>
      <div class="row">
        <label>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö</label>
        <textarea id="fData" placeholder='‡∏ß‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ JavaScript ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ data ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô:
[
  { "q":"‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 1?", "a":["‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡∏Å","‡∏Ç","‡∏Ñ","‡∏á"], "c":0, "ex":"‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢" },
  { "q":"‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° 2?", "a":["‡∏Å","‡∏Ç","‡∏Ñ","‡∏á"], "c":2 }
]'></textarea>
      </div>
      <div class="note">
        ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏î: ‡∏ß‡∏≤‡∏á <code class="k">const data = [ ... ]</code> ‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á ‚úî ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏ö 10 ‡∏Ç‡πâ‡∏≠ ‚úî ‡∏à‡∏∞‡∏°‡∏µ 2‚Äì5 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡πá‡πÑ‡∏î‡πâ
      </div>
      <div class="hlp">Tips: ‡∏Å‡∏î ‚Äú‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏ô‡πÅ‡∏ú‡∏á‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á</div>
    </div>
  </div>
  <footer>
    <input type="file" id="fileImport" accept=".json,.txt" hidden />
    <button id="btnSample" class="btn btn-ghost">‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
    <button id="btnImport" class="btn btn-ghost">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå</button>
    <button id="btnSave" class="btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡πÄ‡∏£‡∏¥‡πà‡∏°</button>
  </footer>
</div>

<script>
/* ===== ‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô ===== */
const DEFAULTS = {
  LOGO_URL   : "https://img5.pic.in.th/file/secure-sv1/LOGO-Open-Sheets.jpg",
  LINE_OA_ID : "@openshetts",
  SHOP_URL   : "https://www.opensheetsstore.com/product/376/%E0%B9%81%E0%B8%99%E0%B8%A7%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%AA%E0%B8%AD%E0%B8%9A-%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%9E%E0%B8%B1%E0%B8%92%E0%B8%99%E0%B8%B2%E0%B8%A3%E0%B8%B0%E0%B8%9A%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%8A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%9B%E0%B8%8F%E0%B8%B4%E0%B8%9A%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B8%81%E0%B8%B2%E0%B8%A3-%E0%B8%AA%E0%B8%B3%E0%B8%99%E0%B8%B1%E0%B8%81%E0%B8%87%E0%B8%B2%E0%B8%99-%E0%B8%81-%E0%B8%9E-%E0%B8%A3-%E0%B8%AD%E0%B8%B1%E0%B8%9B%E0%B9%80%E0%B8%94%E0%B8%95%E0%B8%A5%E0%B9%88%E0%B8%B2%E0%B8%AA%E0%B8%B8%E0%B8%94%E0%B8%9B%E0%B8%B5-2568-%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B2",
  TITLE      : "‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏≠‡∏ö: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå",
  SUBTITLE   : "‡∏Å‡∏£‡∏°‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®"
};

/* ====== ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á data (‡∏ß‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢) ====== */
const SAMPLE_DATA = [
  {q:"‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡πÇ‡∏•‡∏Å (WTO) ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°?",
   a:["‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥ (Non-Discrimination)","‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡πÄ‡∏™‡∏£‡∏µ (Free Trade)","‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ (Transparency)","‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á (Safeguard)"],
   c:0, ex:"‡∏£‡∏ß‡∏° MFN + National Treatment ‡πÉ‡∏´‡πâ‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏°"},
  {q:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏Å‡∏•‡∏á‡πÉ‡∏î‡∏Ç‡∏≠‡∏á WTO ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤?",
   a:["GATT","GATS","TRIPS","TBT"], c:2, ex:"TRIPS = Trade-Related Aspects of IPR"},
  {q:"‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏™‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á AEC Blueprint?",
   a:["‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏î‡∏µ‡∏¢‡∏ß","‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏µ‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô","‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡πÇ‡∏•‡∏Å","‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏ô"], c:3, ex:"AEC 2025 ‡∏°‡∏µ 4 ‡πÄ‡∏™‡∏≤ ‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô"},
  {q:"‡∏Å‡∏é‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Rules of Origin) ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏û‡∏£‡∏≤‡∏∞?",
   a:["‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏†‡∏≤‡∏©‡∏µ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏Ñ‡∏µ‡∏à‡∏£‡∏¥‡∏á","‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° SPS","‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤"], c:1, ex:"‡∏Å‡∏±‡∏ô‡∏™‡∏ß‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"},
  {q:'"Single Undertaking" ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á?',
   a:["‡∏£‡∏±‡∏ö‡∏ö‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÑ‡∏î‡πâ","‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î","‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏ó‡∏µ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠","‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÑ‡∏î‡πâ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà"], c:1, ex:'‚ÄúNothing is agreed until everything is agreed.‚Äù'},
  {q:"‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏ï‡πà‡∏™‡∏ß‡∏ô Anti-Dumping?",
   a:["‡∏Å‡∏£‡∏°‡∏®‡∏∏‡∏•‡∏Å‡∏≤‡∏Å‡∏£","‡∏Å‡∏£‡∏°‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®","‡∏Å‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®","‡∏™‡∏Ñ‡∏Å.‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤"], c:2, ex:"DFT ‡∏î‡∏π‡πÅ‡∏• AD/CVD/Safeguards"},
  {q:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏î‡πà‡∏ô RCEP vs CPTPP?",
   a:["RCEP ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤","RCEP ‡∏£‡∏¥‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢‡∏à‡∏µ‡∏ô, CPTPP ‡πÇ‡∏î‡∏¢‡∏™‡∏´‡∏£‡∏±‡∏ê","RCEP ‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å/‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏£‡∏ß‡∏°‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏ß‡πà‡∏≤","CPTPP ‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ RCEP ‡πÄ‡∏ô‡πâ‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£"], c:2, ex:"RCEP 15 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® ‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏î GDP+‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£"},
  {q:"BATNA ‡∏Ñ‡∏∑‡∏≠?",
   a:["‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏µ‡πà‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î","‡∏à‡∏∏‡∏î‡∏¢‡∏∑‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢","‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô"], c:2, ex:"BATNA ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á = ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏™‡∏π‡∏á"},
  {q:"CBAM ‡∏£‡∏∞‡∏¢‡∏∞‡πÅ‡∏£‡∏Å EU ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏î‡∏°‡∏≤‡∏Å?",
   a:["‡πÄ‡∏Å‡∏©‡∏ï‡∏£/‡∏≠‡∏≤‡∏´‡∏≤‡∏£","‡πÄ‡∏´‡∏•‡πá‡∏Å ‡∏≠‡∏∞‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏° ‡∏õ‡∏∏‡πã‡∏¢ (‡∏Ø‡∏•‡∏Ø)","‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå/‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå","‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏≠"], c:1, ex:"‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô‡∏™‡∏π‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏´‡∏•‡πá‡∏Å ‡∏õ‡∏∏‡πã‡∏¢ ‡∏ã‡∏µ‡πÄ‡∏°‡∏ô‡∏ï‡πå"},
  {q:"National Single Window (NSW) ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ó‡∏¢‡∏Ñ‡∏∑‡∏≠?",
   a:["‡∏û‡∏≠‡∏£‡πå‡∏ó‡∏±‡∏• BOI","‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤-‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å/‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß","‡∏Ñ‡∏•‡∏±‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤","‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏ê"], c:1, ex:"‡∏•‡∏î‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß"}
];

/* ===== ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á DOM ===== */
const q = document.getElementById('q');
const list = document.getElementById('answers');
const ex = document.getElementById('ex');
const exText = document.getElementById('ex-text');
const prog = document.getElementById('progress');
const next = document.getElementById('next');
const panel = document.getElementById('panel');
const result = document.getElementById('result');
const scoreEl = document.getElementById('score');
const restart = document.getElementById('restart');
const logo = document.getElementById('logo');
const btnLine = document.getElementById('btnLine');
const btnShop = document.getElementById('btnShop');
const titleEl = document.getElementById('title');
const subEl = document.getElementById('subtitle');
const lineIdEl = document.getElementById('lineid');

/* Panel elements */
const tpl = document.getElementById('tpl');
const openPanel = document.getElementById('openPanel');
const closePanel = document.getElementById('closePanel');
const restart2 = document.getElementById('restart2');
const fLogo = document.getElementById('fLogo');
const fTitle = document.getElementById('fTitle');
const fSub = document.getElementById('fSub');
const fLine = document.getElementById('fLine');
const fShop = document.getElementById('fShop');
const fData = document.getElementById('fData');
const btnSave = document.getElementById('btnSave');
const btnSample = document.getElementById('btnSample');
const btnImport = document.getElementById('btnImport');
const fileImport = document.getElementById('fileImport');

/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ===== */
let i=0,score=0,locked=false;
let data = [...SAMPLE_DATA]; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

/* ===== Utils ===== */
const LETTERS = "‡∏Å‡∏Ç‡∏Ñ‡∏á‡∏à‡∏â‡∏ä‡∏ã‡∏å‡∏ç‡∏é‡∏è‡∏ê‡∏ë‡∏í‡∏ì‡∏î‡∏ï‡∏ñ‡∏ó‡∏ò‡∏ô‡∏ö‡∏õ‡∏ú‡∏û‡∏ù‡∏ü‡∏†‡∏°‡∏¢‡∏£‡∏•‡∏ß‡∏®‡∏©‡∏™‡∏´‡∏¨‡∏≠‡∏Æ"; // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå‡∏¢‡∏≤‡∏ß ‡πÜ
function safeParseData(txt){
  if(!txt||!txt.trim()) return null;
  // ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á "const data = [ ... ]" ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå
  let s = txt.trim();
  // ‡∏ï‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô "const data ="
  const m = s.match(/\[\s*[\s\S]*\]/);
  if(m) s = m[0];
  try{
    const arr = JSON.parse(s);
    if(Array.isArray(arr)) return arr;
  }catch(e){
    // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° parse JSON ‡πÅ‡∏ö‡∏ö keys ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏û‡∏π‡∏î (‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏±‡∏î‡∏°‡∏≤‡∏à‡∏≤‡∏Å JS ‡∏Ç‡πâ‡∏≤‡∏á‡∏ô‡∏≠‡∏Å)
    try{
      const fixed = s
        .replace(/(\W)q\s*:/g,'$1"q":')
        .replace(/(\W)a\s*:/g,'$1"a":')
        .replace(/(\W)c\s*:/g,'$1"c":')
        .replace(/(\W)ex\s*:/g,'$1"ex":')
        .replace(/'/g,'"');
      const arr2 = JSON.parse(fixed);
      if(Array.isArray(arr2)) return arr2;
    }catch(e2){
      alert("‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à\n\n‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö JSON ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
    }
  }
  return null;
}
function saveToLocal(k,v){ try{ localStorage.setItem(k,JSON.stringify(v)); }catch{} }
function loadFromLocal(k,def){ try{ const v=localStorage.getItem(k); return v?JSON.parse(v):def; }catch{return def;} }

/* ===== ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö ===== */
function render(){
  locked=false; next.disabled=true; ex.style.display="none"; list.innerHTML="";
  const item = data[i];
  q.textContent = `‡∏Ç‡πâ‡∏≠ ${i+1}. ${item.q || ""}`;
  prog.textContent = `‡∏Ç‡πâ‡∏≠ ${i+1} / ${data.length}`;
  (item.a||[]).forEach((t,k)=>{
    const b=document.createElement('button');
    b.className='opt'; b.type='button';
    const label = (LETTERS[k]||"?");
    b.textContent = `${label}. ${t}`;
    b.onclick=()=>choose(k === Number(item.c));
    list.appendChild(b);
  });
  // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ö‡∏≤ ‡πÜ)
  if(!item.a || item.a.length===0){
    const n=document.createElement('div');
    n.style.color="#b02a37"; n.style.fontWeight="700";
    n.textContent="* ‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å";
    list.appendChild(n);
  }
}
function choose(ok){
  if(locked) return; locked=true;
  [...list.children].forEach((b,idx)=>{
    if(!b.classList) return;
    b.disabled=true;
    b.classList.add(idx===Number(data[i].c) ? 'correct' : 'wrong');
  });
  if(ok) score++;
  exText.textContent = data[i].ex || "‚Äî";
  ex.style.display="block";
  next.textContent = (i===data.length-1) ? "‡∏î‡∏π‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô" : "‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠‡πÑ‡∏õ";
  next.disabled=false;
}
function goNext(){
  if(i < data.length-1){ i++; render(); }
  else{
    panel.style.display='none';
    result.style.display='block';
    scoreEl.textContent=`${score} / ${data.length}`;
  }
}
function reset(){ i=0; score=0; panel.style.display='block'; result.style.display='none'; render(); }

/* ===== ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© ===== */
function applyHeader(cfg){
  logo.src = cfg.LOGO_URL || DEFAULTS.LOGO_URL;
  titleEl.textContent = cfg.TITLE || DEFAULTS.TITLE;
  subEl.textContent = cfg.SUBTITLE || DEFAULTS.SUBTITLE;
  lineIdEl.textContent = cfg.LINE_OA_ID || DEFAULTS.LINE_OA_ID;
  const lineMsg = "https://line.me/R/ti/p/@304czfla?ts=02101411&oat_content=url" + location.href;
  btnLine.href = 'https://line.me/R/ti/p/@304czfla?ts=02101411&oat_content=url' + encodeURIComponent(cfg.LINE_OA_ID || DEFAULTS.LINE_OA_ID) + '/?' + encodeURIComponent(lineMsg);
  btnShop.href = cfg.SHOP_URL || DEFAULTS.SHOP_URL;
}
const storedCfg = loadFromLocal("opensheets_quiz_cfg", DEFAULTS);
applyHeader(storedCfg);

/* ===== ‡∏õ‡∏∏‡πà‡∏°/‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏´‡∏•‡∏±‡∏Å ===== */
next.addEventListener('click',goNext);
restart.addEventListener('click',reset);

/* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡πä‡∏≠‡∏õ‡∏á‡πà‡∏≤‡∏¢ ‡πÜ */
document.addEventListener('keydown',function(e){
  const k=(e.ctrlKey||e.metaKey) && ['s','S','u','U','p','P','c','C'].includes(e.key);
  const fkeys=[123]; // F12
  if(k || fkeys.includes(e.keyCode)){ e.preventDefault(); e.stopPropagation(); }
},true);
document.addEventListener('dragstart',e=>e.preventDefault());
document.addEventListener('copy',e=>e.preventDefault());

/* ===== ‡πÅ‡∏ú‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ===== */
function openTpl(){
  fLogo.value = storedCfg.LOGO_URL || DEFAULTS.LOGO_URL;
  fTitle.value = storedCfg.TITLE || DEFAULTS.TITLE;
  fSub.value = storedCfg.SUBTITLE || DEFAULTS.SUBTITLE;
  fLine.value = storedCfg.LINE_OA_ID || DEFAULTS.LINE_OA_ID;
  fShop.value = storedCfg.SHOP_URL || DEFAULTS.SHOP_URL;
  fData.value = "";
  tpl.style.display='block';
}
function closeTpl(){ tpl.style.display='none'; }

openPanel.addEventListener('click',openTpl);
closePanel.addEventListener('click',closeTpl);
restart2.addEventListener('click',reset);

btnSample.addEventListener('click',()=>{
  fData.value = JSON.stringify(SAMPLE_DATA, null, 2);
});
btnImport.addEventListener('click',()=>fileImport.click());
fileImport.addEventListener('change',async (e)=>{
  const file = e.target.files?.[0];
  if(!file) return;
  const text = await file.text();
  fData.value = text;
});

btnSave.addEventListener('click',()=>{
  // 1) ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©
  const cfg = {
    LOGO_URL   : fLogo.value.trim() || DEFAULTS.LOGO_URL,
    TITLE      : fTitle.value.trim() || DEFAULTS.TITLE,
    SUBTITLE   : fSub.value.trim() || DEFAULTS.SUBTITLE,
    LINE_OA_ID : fLine.value.trim() || DEFAULTS.LINE_OA_ID,
    SHOP_URL   : fShop.value.trim() || DEFAULTS.SHOP_URL
  };
  applyHeader(cfg);
  saveToLocal("opensheets_quiz_cfg", cfg);

  // 2) ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö => ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏ä‡∏∏‡∏î
  const parsed = safeParseData(fData.value);
  if(parsed && Array.isArray(parsed) && parsed.length){
    data = parsed.map(x=>({
      q: x.q ?? "",
      a: Array.isArray(x.a) ? x.a : [],
      c: typeof x.c==="number" ? x.c : 0,
      ex: x.ex ?? ""
    }));
  }

  // 3) ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
  closeTpl();
  reset();
});

/* ===== ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ===== */
reset();
</script>
</body>
</html>
